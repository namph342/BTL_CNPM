{% extends 'layout/base.html' %}

{% block navbar %}
{% include 'layout/quanly_navbar.html' %}
{% endblock %}

{% block title %}Trang quản lý phòng{% endblock %}

{% block content %}

{% with messages = get_flashed_messages(with_categories=true) %}
{% if messages %}
{% for category, message in messages %}
<div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
    {{ message }}
    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
</div>
{% endfor %}
{% endif %}
{% endwith %}
<div class="container mt-4">

    <div class="table-container">
        <table class="custom-table">
            <thead>
            <tr>
                <th>STT</th>
                <th>Mã căn</th>
                <th>Diện tích</th>
                <th>Sức chứa</th>
                <th>Giá thuê</th>
                <th>Tình trạng</th>
                <th>Hành động</th>
            </tr>
            </thead>
            <tbody>
            {% for p in list_phong %}
            <tr>
                <td>{{ loop.index }}</td>

                <td><strong>{{ p.name }}</strong></td>

                <td>{{ p.acreage }} m²</td>

                <td>{{ p.capacity }} người</td>

                <td style="font-weight: bold;">
                    {{ "{:,.0f}".format(p.price) }} đ
                </td>

                <td>
                    {% if p.status == 'Đã thuê' or p.status == 'DA_THUE' %}
                    <span class="badge bg-danger rounded-pill">Đã thuê</span>
                    {% else %}
                    <span class="badge bg-success rounded-pill">Trống</span>
                    {% endif %}
                </td>

                <td>
                    <a href="{{ url_for('edit_canho', canho_id=p.id) }}"
                       class="btn btn-sm btn-outline-primary">
                        <i class="bi bi-pencil-square"></i>
                    </a>
                    <form action="{{ url_for('delete_apartment', id=p.id) }}"
                          method="post"
                          style="display:inline"
                          onsubmit="return confirm('Bạn có chắc muốn xóa căn này không?');">
                        <button type="submit" class="btn btn-sm btn-outline-danger">
                            <i class="bi bi-trash"></i>
                        </button>
                    </form>
                </td>
            </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>

</div>

{% endblock %}